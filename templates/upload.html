<a href="index.php" class="button">&larr; Back to submissions page</a>

<h1>Upload files for $assignment</h1>

<p>
Use the upload fields below for each file required by this assignment.
You can upload many files at a time. Any new uploads will
<em>replace</em> the existing files. If a file has already been uploaded,
not filling an upload field for that file will not change that file.
However, if you upload a new version of a file, that file's timestamp
will be updated &mdash; we will calculate the late penalty based on the most
recent version uploaded.
</p>

<p>
If a file&rsquo;s deadline has passed or submissions are not yet being
accepted for that file, its upload field will be disabled.
</p>

$formtag
<input type="hidden" name="MAX_FILE_SIZE" value="1000000">

$rows

<div class="row">
    <div class="left"></div>
    <div class="right"><input type="submit" class="input-submit" value="Upload"></div>
</div>

<input type="hidden" name="submitted">
</form>

<script type="text/javascript">
var filesChosen = 0;
var submitting = false;
var els = document.getElementsByClassName('input-file');

function setChosen() {
    filesChosen++;
}

for (var i = 0; i < els.length; i++) {
    els[i].onchange = setChosen;
}

function setSubmitting() {
    submitting = true;
}

var submitEls = document.getElementsByClassName('input-submit');

for (var i = 0; i < submitEls.length; i++) {
    submitEls[i].onclick = setSubmitting;
}

window.onbeforeunload = function (e) {
    if (filesChosen == 0 || submitting) {
        return;
    }

    if (filesChosen == 1) {
        var s = 'file';
    } else {
        var s = 'files';
    }

    var msg = 'The ' + s + ' you chose will not be uploaded. If you want to ' +
              'upload files, click the Upload button at the bottom of the page.';

    e = e || window.event;

    if (e) {
        e.returnValue = msg;
    }

    return msg;
};
</script>
